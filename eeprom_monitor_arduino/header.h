// Copyright (c) 2025 MR MODULE PTY LTD
// Licensed under the MIT License

#ifndef _header_h
#define _header_h

#include <Arduino.h>
#include <Wire.h>
#include <EEPROM.h>

#define SERIAL_BAUD 38400

#define EEPROM_I2C_ADDRESS 0x51  // 24C02 with A0/A1/A2 = 001

#define EEPROM_DATA { \
    0x18, 0x03, 0x94, 0x4F, 0x91, 0x91, 0xDE, 0x52, 0xA8, 0x3C, 0xFF, 0x41, 0x20, 0x55, 0xFF, 0x0A, \
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0x07, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xCC, 0xD3, 0x5B, 0x10, 0x01, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xDE, 0x07, 0xEC, 0x07, 0x7E, 0x08, 0xCC, 0x08, 0xEC, 0x08, 0x3C, 0x09, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xDE, 0x07, 0xEC, 0x07, 0x7E, 0x08, 0xCC, 0x08, 0xEC, 0x08, 0x3C, 0x09, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x04, 0x04, 0x16, 0x00, \
    0xDA, 0x03, 0x22, 0x04, 0xCD, 0x04, 0xAE, 0x05, 0xC5, 0x06, 0x24, 0x08, 0x33, 0x52, 0x32, 0x33, \
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x01, 0xFF, 0xFF, \
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, \
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF  \
  };

#define EEPROM_FLAG_VALUE 0xA5
#define EEPROM_DATA_VALID_FLAG 320 //these flag locations must come after data + flag tables (256 bytes, 32 bytes, 32 bytes)
#define EEPROM_ACCESSED_VALID_FLAG 321
#define EEPROM_MODIFIED_VALID_FLAG 322


extern volatile uint8_t mem_address;
extern volatile uint8_t eeprom_data[256];
extern uint8_t accessed_flags[32];
extern uint8_t modified_flags[32];

extern void processSerialCommands();
extern void resetEepromState();


#endif
